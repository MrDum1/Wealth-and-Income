---
title: "Wealth and Debt"
author: "Walter"
date: "2024-07-22"
output: html_document
---

Question: What is the Relationship/Connection between A race's wealth, and their student debt?

Packages installed

```{r}
install.packages("tidyverse")
library(tidyverse)
install.packages("kableExtra")
library(kableExtra)
```

Loaded Data sets

```{r}
lifetime_earn <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/lifetime_earn.csv')
student_debt <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/student_debt.csv')
retirement <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/retirement.csv')
home_owner <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/home_owner.csv')
race_wealth <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/race_wealth.csv')
income_time <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_time.csv')
income_limits <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_limits.csv')
income_aggregate <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_aggregate.csv')
income_distribution <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_distribution.csv')
income_mean <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_mean.csv')
```

Cleaning Data sets: Race wealth and Student Debt

```{r}
race_wealth_clean <- race_wealth %>% 
  mutate(wealth_family = round(wealth_family)) %>%
  filter(!is.na(wealth_family)) %>%
  arrange(desc(year)) %>%
  pivot_wider( names_from = c(race, type), values_from = wealth_family) %>%
  select(- c("Non-White_Average", "Non-White_Median")) %>%
  filter(year >= 1989)

student_debt_clean <- student_debt %>%
  mutate(loan_debt = round(loan_debt)) %>%
  arrange(desc(year)) %>%
  pivot_wider(names_from = race, values_from = c(loan_debt, loan_debt_pct))%>%
  select(year, loan_debt_White, loan_debt_pct_White, loan_debt_Black, loan_debt_pct_Black, loan_debt_Hispanic, loan_debt_pct_Hispanic)
```

Create Race wealth data set for plotting

```{r}
race_wealth_plot <- race_wealth %>% 
  mutate(wealth_family = round(wealth_family)) %>%
  filter(!is.na(wealth_family)) %>%
  arrange(desc(year)) %>%
  filter(year >= 1989)

Wealth_avg <- subset(race_wealth_plot, type == "Average")
Wealth_med <- subset(race_wealth_plot, type == "Median") 

race_wealth_plot <- merge(Wealth_avg, Wealth_med, by = c("year")) %>%
  rename(average = type.x, median = type.y, average_race = race.x, median_race = race.y, average_income = wealth_family.x, median_income = wealth_family.y)
```

Plotting Data set: Average Race Wealth

```{r}
ggplot(race_wealth_plot) +
          aes(x = year, y = average_income, colour = average_race) +
          geom_line(linewidth = 3L) +
          scale_color_viridis_d(option = "inferno", direction = 1) +
          labs(
            x = "Year",
            y = "Average Income",
            title = "Average Race Wealth"
          ) +
          theme_minimal() +
          theme(
            legend.text = element_text(size = 11L),
            legend.title = element_text(size = 11L)
          ) +
          facet_wrap(vars(average))

```

Notes:

-   Slight drop between 2007-2010

-   Slight increase 2004-2007

Plotting Data set: Median Race Wealth

```{r}
ggplot(race_wealth_plot) +
  aes(x = year, y = median_income, colour = median_race) +
  geom_line(linewidth = 3L) +
  scale_color_viridis_d(option = "inferno", direction = 1) +
  labs(
    x = "Year",
    y = "Median Income",
    title = "Median Race Wealth"
  ) +
  theme_minimal() +
  theme(legend.text = element_text(size = 11L)) +
  facet_wrap(vars(median))
```

Notes:

-   Slight drop between 2007-2010 (White having a huge decrease in that time)

-   Little to no increase

Plotting Data set: Percentage Student Debt

```{r}
ggplot(student_debt) +
  aes(x = year, y = loan_debt_pct, colour = race) +
  geom_line(linewidth = 3L) +
  scale_color_viridis_d(option = "inferno", direction = 1) +
  labs(title = "Student Debt (Percentage)", x = "Year", y = "Loan Debt Percentage") +
  theme_minimal()
```

Notes:

-   Some fluctuation between 1989-2001

-   Large increase in all races (2007- 2016)

plotting Data set: Student Debt (\$)

```{r}
ggplot(student_debt) +
  aes(x= year, y = loan_debt, colour = race) + 
  geom_line(linewidth = 3L) +
  scale_color_viridis_d(option = "inferno", direction = 1) +
  labs(title = "Student Debt ($)", x = "Year", y = "Loan Debt ($)") +
  theme_minimal()
```

Notes:

-   Large increase between 2013-2016

-   Little to no decrease

Neatly show data:

```{r}
kable(race_wealth_clean) %>%
  kable_styling("striped","bordered")

kable(student_debt_clean) %>%
  kable_styling("striped","bordered")
```
